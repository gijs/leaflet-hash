function(d){var e,f=d.documentMode;e="onhashchange"in d&&(void 0===f||7<f);L.Hash=function(a){this.onHashChange=L.Util.bind(this.onHashChange,this);a&&this.init(a)};L.Hash.prototype={map:null,lastHash:null,parseHash:function(a){0==a.indexOf("#")&&(a=a.substr(1));var b=a.split("/");if(3==b.length){var a=parseInt(b[0],10),c=parseFloat(b[1]),b=parseFloat(b[2]);return isNaN(a)||isNaN(c)||isNaN(b)?!1:{center:new L.LatLng(c,b),zoom:a}}return!1},formatHash:function(a){var b=a.getCenter(),a=a.getZoom(),
c=Math.max(0,Math.ceil(Math.log(a)/Math.LN2));return"#"+[a,b.lat.toFixed(c),b.lng.toFixed(c)].join("/")},init:function(a){this.map=a;this.map.on("moveend",this.onMapMove,this);this.lastHash=null;this.onHashChange();this.isListening||this.startListening()},remove:function(){this.map=null;this.isListening&&this.stopListening()},onMapMove:function(){if(this.movingMap||0===this.map.getZoom())return!1;var a=this.formatHash(this.map);this.lastHash!=a&&(location.replace(a),this.lastHash=a)},movingMap:!1,
update:function(){var a=location.hash;if(a!==this.lastHash)if(a=this.parseHash(a))this.movingMap=!0,this.map.setView(a.center,a.zoom),this.movingMap=!1;else this.onMapMove(this.map)},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var a=this;this.changeTimeout=setTimeout(function(){a.update();a.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){e?L.DomEvent.addListener(d,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),
this.hashChangeInterval=setInterval(this.onHashChange,50));this.isListening=!0},stopListening:function(){e?L.DomEvent.removeListener(d,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval);this.isListening=!1}};L.hash=function(a){return new L.Hash(a)};L.Map.prototype.addHash=function(){L.hash(this)}})(window);